{"ast":null,"code":"const KarmaEventEmitter = require('../events').EventEmitter;\n\nconst EventEmitter = require('events').EventEmitter;\n\nconst log = require('../logger').create('launcher');\n\nconst helper = require('../helper');\n\nconst BEING_CAPTURED = 'BEING_CAPTURED';\nconst CAPTURED = 'CAPTURED';\nconst BEING_KILLED = 'BEING_KILLED';\nconst FINISHED = 'FINISHED';\nconst RESTARTING = 'RESTARTING';\nconst BEING_FORCE_KILLED = 'BEING_FORCE_KILLED';\n/**\n * Base launcher that any custom launcher extends.\n */\n\nfunction BaseLauncher(id, emitter) {\n  if (this.start) {\n    return;\n  } // TODO(vojta): figure out how to do inheritance with DI\n\n\n  Object.keys(EventEmitter.prototype).forEach(function (method) {\n    this[method] = EventEmitter.prototype[method];\n  }, this);\n  this.bind = KarmaEventEmitter.prototype.bind.bind(this);\n  this.emitAsync = KarmaEventEmitter.prototype.emitAsync.bind(this);\n  this.id = id;\n  this._state = null;\n  Object.defineProperty(this, 'state', {\n    get: () => {\n      return this._state;\n    },\n    set: toState => {\n      log.debug(`${this._state} -> ${toState}`);\n      this._state = toState;\n    }\n  });\n  this.error = null;\n  let killingPromise;\n  let previousUrl;\n\n  this.start = function (url) {\n    previousUrl = url;\n    this.error = null;\n    this.state = BEING_CAPTURED;\n    this.emit('start', url + '?id=' + this.id + (helper.isDefined(this.displayName) ? '&displayName=' + encodeURIComponent(this.displayName) : ''));\n  };\n\n  this.kill = function () {\n    // Already killed, or being killed.\n    if (killingPromise) {\n      return killingPromise;\n    }\n\n    killingPromise = this.emitAsync('kill').then(() => {\n      this.state = FINISHED;\n    });\n    this.state = BEING_KILLED;\n    return killingPromise;\n  };\n\n  this.forceKill = function () {\n    this.kill();\n    this.state = BEING_FORCE_KILLED;\n    return killingPromise;\n  };\n\n  this.restart = function () {\n    if (this.state === BEING_FORCE_KILLED) {\n      return;\n    }\n\n    if (!killingPromise) {\n      killingPromise = this.emitAsync('kill');\n    }\n\n    killingPromise.then(() => {\n      if (this.state === BEING_FORCE_KILLED) {\n        this.state = FINISHED;\n      } else {\n        killingPromise = null;\n        log.debug(`Restarting ${this.name}`);\n        this.start(previousUrl);\n      }\n    });\n    this.state = RESTARTING;\n  };\n\n  this.markCaptured = function () {\n    if (this.state === BEING_CAPTURED) {\n      this.state = CAPTURED;\n    }\n  };\n\n  this.isCaptured = function () {\n    return this.state === CAPTURED;\n  };\n\n  this.toString = function () {\n    return this.name;\n  };\n\n  this._done = function (error) {\n    killingPromise = killingPromise || Promise.resolve();\n    this.error = this.error || error;\n    this.emit('done');\n\n    if (this.error && this.state !== BEING_FORCE_KILLED && this.state !== RESTARTING) {\n      emitter.emit('browser_process_failure', this);\n    }\n\n    this.state = FINISHED;\n  };\n\n  this.STATE_BEING_CAPTURED = BEING_CAPTURED;\n  this.STATE_CAPTURED = CAPTURED;\n  this.STATE_BEING_KILLED = BEING_KILLED;\n  this.STATE_FINISHED = FINISHED;\n  this.STATE_RESTARTING = RESTARTING;\n  this.STATE_BEING_FORCE_KILLED = BEING_FORCE_KILLED;\n}\n\nBaseLauncher.decoratorFactory = function (id, emitter) {\n  return function (launcher) {\n    BaseLauncher.call(launcher, id, emitter);\n  };\n};\n\nmodule.exports = BaseLauncher;","map":{"version":3,"names":["KarmaEventEmitter","require","EventEmitter","log","create","helper","BEING_CAPTURED","CAPTURED","BEING_KILLED","FINISHED","RESTARTING","BEING_FORCE_KILLED","BaseLauncher","id","emitter","start","Object","keys","prototype","forEach","method","bind","emitAsync","_state","defineProperty","get","set","toState","debug","error","killingPromise","previousUrl","url","state","emit","isDefined","displayName","encodeURIComponent","kill","then","forceKill","restart","name","markCaptured","isCaptured","toString","_done","Promise","resolve","STATE_BEING_CAPTURED","STATE_CAPTURED","STATE_BEING_KILLED","STATE_FINISHED","STATE_RESTARTING","STATE_BEING_FORCE_KILLED","decoratorFactory","launcher","call","module","exports"],"sources":["/Users/deliabarbuta/Documents/An4Sem1/PAW/Proiect/proiect-paw-tadam/Frontend_OceanCross/node_modules/karma/lib/launchers/base.js"],"sourcesContent":["const KarmaEventEmitter = require('../events').EventEmitter\nconst EventEmitter = require('events').EventEmitter\n\nconst log = require('../logger').create('launcher')\nconst helper = require('../helper')\n\nconst BEING_CAPTURED = 'BEING_CAPTURED'\nconst CAPTURED = 'CAPTURED'\nconst BEING_KILLED = 'BEING_KILLED'\nconst FINISHED = 'FINISHED'\nconst RESTARTING = 'RESTARTING'\nconst BEING_FORCE_KILLED = 'BEING_FORCE_KILLED'\n\n/**\n * Base launcher that any custom launcher extends.\n */\nfunction BaseLauncher (id, emitter) {\n  if (this.start) {\n    return\n  }\n\n  // TODO(vojta): figure out how to do inheritance with DI\n  Object.keys(EventEmitter.prototype).forEach(function (method) {\n    this[method] = EventEmitter.prototype[method]\n  }, this)\n\n  this.bind = KarmaEventEmitter.prototype.bind.bind(this)\n  this.emitAsync = KarmaEventEmitter.prototype.emitAsync.bind(this)\n\n  this.id = id\n  this._state = null\n  Object.defineProperty(this, 'state', {\n    get: () => {\n      return this._state\n    },\n    set: (toState) => {\n      log.debug(`${this._state} -> ${toState}`)\n      this._state = toState\n    }\n  })\n\n  this.error = null\n\n  let killingPromise\n  let previousUrl\n\n  this.start = function (url) {\n    previousUrl = url\n\n    this.error = null\n    this.state = BEING_CAPTURED\n    this.emit('start', url + '?id=' + this.id + (helper.isDefined(this.displayName) ? '&displayName=' + encodeURIComponent(this.displayName) : ''))\n  }\n\n  this.kill = function () {\n    // Already killed, or being killed.\n    if (killingPromise) {\n      return killingPromise\n    }\n\n    killingPromise = this.emitAsync('kill').then(() => {\n      this.state = FINISHED\n    })\n\n    this.state = BEING_KILLED\n\n    return killingPromise\n  }\n\n  this.forceKill = function () {\n    this.kill()\n    this.state = BEING_FORCE_KILLED\n\n    return killingPromise\n  }\n\n  this.restart = function () {\n    if (this.state === BEING_FORCE_KILLED) {\n      return\n    }\n\n    if (!killingPromise) {\n      killingPromise = this.emitAsync('kill')\n    }\n\n    killingPromise.then(() => {\n      if (this.state === BEING_FORCE_KILLED) {\n        this.state = FINISHED\n      } else {\n        killingPromise = null\n        log.debug(`Restarting ${this.name}`)\n        this.start(previousUrl)\n      }\n    })\n\n    this.state = RESTARTING\n  }\n\n  this.markCaptured = function () {\n    if (this.state === BEING_CAPTURED) {\n      this.state = CAPTURED\n    }\n  }\n\n  this.isCaptured = function () {\n    return this.state === CAPTURED\n  }\n\n  this.toString = function () {\n    return this.name\n  }\n\n  this._done = function (error) {\n    killingPromise = killingPromise || Promise.resolve()\n\n    this.error = this.error || error\n    this.emit('done')\n\n    if (this.error && this.state !== BEING_FORCE_KILLED && this.state !== RESTARTING) {\n      emitter.emit('browser_process_failure', this)\n    }\n\n    this.state = FINISHED\n  }\n\n  this.STATE_BEING_CAPTURED = BEING_CAPTURED\n  this.STATE_CAPTURED = CAPTURED\n  this.STATE_BEING_KILLED = BEING_KILLED\n  this.STATE_FINISHED = FINISHED\n  this.STATE_RESTARTING = RESTARTING\n  this.STATE_BEING_FORCE_KILLED = BEING_FORCE_KILLED\n}\n\nBaseLauncher.decoratorFactory = function (id, emitter) {\n  return function (launcher) {\n    BaseLauncher.call(launcher, id, emitter)\n  }\n}\n\nmodule.exports = BaseLauncher\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}