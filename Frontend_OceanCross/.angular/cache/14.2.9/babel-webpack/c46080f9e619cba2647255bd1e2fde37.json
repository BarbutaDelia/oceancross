{"ast":null,"code":"\"use strict\";\n/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nvar _asyncToGenerator = require(\"/Users/deliabarbuta/Documents/An4Sem1/PAW/Proiect/proiect-paw-tadam/Frontend_OceanCross/node_modules/@babel/runtime/helpers/asyncToGenerator.js\").default;\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n    desc = {\n      enumerable: true,\n      get: function () {\n        return m[k];\n      }\n    };\n  }\n\n  Object.defineProperty(o, k2, desc);\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n\n  __setModuleDefault(result, mod);\n\n  return result;\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.buildWebpackBrowser = exports.BUILD_TIMEOUT = void 0;\n\nconst architect_1 = require(\"@angular-devkit/architect\");\n\nconst build_webpack_1 = require(\"@angular-devkit/build-webpack\");\n\nconst fs = __importStar(require(\"fs\"));\n\nconst path = __importStar(require(\"path\"));\n\nconst rxjs_1 = require(\"rxjs\");\n\nconst operators_1 = require(\"rxjs/operators\");\n\nconst typescript_1 = require(\"typescript\");\n\nconst utils_1 = require(\"../../utils\");\n\nconst bundle_calculator_1 = require(\"../../utils/bundle-calculator\");\n\nconst color_1 = require(\"../../utils/color\");\n\nconst copy_assets_1 = require(\"../../utils/copy-assets\");\n\nconst error_1 = require(\"../../utils/error\");\n\nconst i18n_inlining_1 = require(\"../../utils/i18n-inlining\");\n\nconst index_html_generator_1 = require(\"../../utils/index-file/index-html-generator\");\n\nconst normalize_cache_1 = require(\"../../utils/normalize-cache\");\n\nconst output_paths_1 = require(\"../../utils/output-paths\");\n\nconst package_chunk_sort_1 = require(\"../../utils/package-chunk-sort\");\n\nconst purge_cache_1 = require(\"../../utils/purge-cache\");\n\nconst service_worker_1 = require(\"../../utils/service-worker\");\n\nconst spinner_1 = require(\"../../utils/spinner\");\n\nconst supported_browsers_1 = require(\"../../utils/supported-browsers\");\n\nconst version_1 = require(\"../../utils/version\");\n\nconst webpack_browser_config_1 = require(\"../../utils/webpack-browser-config\");\n\nconst configs_1 = require(\"../../webpack/configs\");\n\nconst async_chunks_1 = require(\"../../webpack/utils/async-chunks\");\n\nconst helpers_1 = require(\"../../webpack/utils/helpers\");\n\nconst stats_1 = require(\"../../webpack/utils/stats\");\n/**\n * Maximum time in milliseconds for single build/rebuild\n * This accounts for CI variability.\n */\n\n\nexports.BUILD_TIMEOUT = 30000;\n\nfunction initialize(_x, _x2, _x3) {\n  return _initialize.apply(this, arguments);\n}\n/**\n * @experimental Direct usage of this function is considered experimental.\n */\n// eslint-disable-next-line max-lines-per-function\n\n\nfunction _initialize() {\n  _initialize = _asyncToGenerator(function* (options, context, webpackConfigurationTransform) {\n    var _a, _b;\n\n    const originalOutputPath = options.outputPath; // Assets are processed directly by the builder except when watching\n\n    const adjustedOptions = options.watch ? options : { ...options,\n      assets: []\n    };\n    const {\n      config,\n      projectRoot,\n      projectSourceRoot,\n      i18n,\n      target\n    } = yield (0, webpack_browser_config_1.generateI18nBrowserWebpackConfigFromContext)(adjustedOptions, context, wco => [(0, configs_1.getCommonConfig)(wco), (0, configs_1.getStylesConfig)(wco), (0, configs_1.getAnalyticsConfig)(wco, context)]); // Validate asset option values if processed directly\n\n    if (((_a = options.assets) === null || _a === void 0 ? void 0 : _a.length) && !((_b = adjustedOptions.assets) === null || _b === void 0 ? void 0 : _b.length)) {\n      (0, utils_1.normalizeAssetPatterns)(options.assets, context.workspaceRoot, projectRoot, projectSourceRoot).forEach(({\n        output\n      }) => {\n        if (output.startsWith('..')) {\n          throw new Error('An asset cannot be written to a location outside of the output path.');\n        }\n      });\n    }\n\n    let transformedConfig;\n\n    if (webpackConfigurationTransform) {\n      transformedConfig = yield webpackConfigurationTransform(config);\n    }\n\n    if (options.deleteOutputPath) {\n      (0, utils_1.deleteOutputDir)(context.workspaceRoot, originalOutputPath);\n    }\n\n    return {\n      config: transformedConfig || config,\n      projectRoot,\n      projectSourceRoot,\n      i18n,\n      target\n    };\n  });\n  return _initialize.apply(this, arguments);\n}\n\nfunction buildWebpackBrowser(options, context, transforms = {}) {\n  var _a;\n\n  const projectName = (_a = context.target) === null || _a === void 0 ? void 0 : _a.project;\n\n  if (!projectName) {\n    throw new Error('The builder requires a target.');\n  }\n\n  const baseOutputPath = path.resolve(context.workspaceRoot, options.outputPath);\n  let outputPaths; // Check Angular version.\n\n  (0, version_1.assertCompatibleAngularVersion)(context.workspaceRoot);\n  return (0, rxjs_1.from)(context.getProjectMetadata(projectName)).pipe((0, operators_1.switchMap)( /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator(function* (projectMetadata) {\n      var _a;\n\n      var _b; // Purge old build disk cache.\n\n\n      yield (0, purge_cache_1.purgeStaleBuildCache)(context); // Initialize builder\n\n      const initialization = yield initialize(options, context, transforms.webpackConfiguration); // Check and warn about IE browser support\n\n      checkInternetExplorerSupport(initialization.projectRoot, context.logger); // Add index file to watched files.\n\n      if (options.watch) {\n        const indexInputFile = path.join(context.workspaceRoot, (0, webpack_browser_config_1.getIndexInputFile)(options.index));\n        (_a = (_b = initialization.config).plugins) !== null && _a !== void 0 ? _a : _b.plugins = [];\n        initialization.config.plugins.push({\n          apply: compiler => {\n            compiler.hooks.thisCompilation.tap('build-angular', compilation => {\n              compilation.fileDependencies.add(indexInputFile);\n            });\n          }\n        });\n      }\n\n      return { ...initialization,\n        cacheOptions: (0, normalize_cache_1.normalizeCacheOptions)(projectMetadata, context.workspaceRoot)\n      };\n    });\n\n    return function (_x4) {\n      return _ref.apply(this, arguments);\n    };\n  }()), (0, operators_1.switchMap)( // eslint-disable-next-line max-lines-per-function\n  ({\n    config,\n    projectRoot,\n    projectSourceRoot,\n    i18n,\n    target,\n    cacheOptions\n  }) => {\n    const normalizedOptimization = (0, utils_1.normalizeOptimization)(options.optimization);\n    return (0, build_webpack_1.runWebpack)(config, context, {\n      webpackFactory: require('webpack'),\n      logging: transforms.logging || ((stats, config) => {\n        if (options.verbose) {\n          context.logger.info(stats.toString(config.stats));\n        }\n      })\n    }).pipe((0, operators_1.concatMap)( /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator(function* (buildEvent) {\n        var _a, _b, _c, _d, _e, _f, _g, _h;\n\n        const spinner = new spinner_1.Spinner();\n        spinner.enabled = options.progress !== false;\n        const {\n          success,\n          emittedFiles = [],\n          outputPath: webpackOutputPath\n        } = buildEvent;\n        const webpackRawStats = buildEvent.webpackStats;\n\n        if (!webpackRawStats) {\n          throw new Error('Webpack stats build result is required.');\n        } // Fix incorrectly set `initial` value on chunks.\n\n\n        const extraEntryPoints = [...(0, helpers_1.normalizeExtraEntryPoints)(options.styles || [], 'styles'), ...(0, helpers_1.normalizeExtraEntryPoints)(options.scripts || [], 'scripts')];\n        const webpackStats = { ...webpackRawStats,\n          chunks: (0, async_chunks_1.markAsyncChunksNonInitial)(webpackRawStats, extraEntryPoints)\n        };\n\n        if (!success) {\n          // If using bundle downleveling then there is only one build\n          // If it fails show any diagnostic messages and bail\n          if ((0, stats_1.statsHasWarnings)(webpackStats)) {\n            context.logger.warn((0, stats_1.statsWarningsToString)(webpackStats, {\n              colors: true\n            }));\n          }\n\n          if ((0, stats_1.statsHasErrors)(webpackStats)) {\n            context.logger.error((0, stats_1.statsErrorsToString)(webpackStats, {\n              colors: true\n            }));\n          }\n\n          return {\n            success\n          };\n        } else {\n          outputPaths = (0, output_paths_1.ensureOutputPaths)(baseOutputPath, i18n);\n          const scriptsEntryPointName = (0, helpers_1.normalizeExtraEntryPoints)(options.scripts || [], 'scripts').map(x => x.bundleName);\n\n          if (i18n.shouldInline) {\n            const success = yield (0, i18n_inlining_1.i18nInlineEmittedFiles)(context, emittedFiles, i18n, baseOutputPath, Array.from(outputPaths.values()), scriptsEntryPointName, webpackOutputPath, target <= typescript_1.ScriptTarget.ES5, options.i18nMissingTranslation);\n\n            if (!success) {\n              return {\n                success: false\n              };\n            }\n          } // Check for budget errors and display them to the user.\n\n\n          const budgets = options.budgets;\n          let budgetFailures;\n\n          if (budgets === null || budgets === void 0 ? void 0 : budgets.length) {\n            budgetFailures = [...(0, bundle_calculator_1.checkBudgets)(budgets, webpackStats)];\n\n            for (const {\n              severity,\n              message\n            } of budgetFailures) {\n              switch (severity) {\n                case bundle_calculator_1.ThresholdSeverity.Warning:\n                  (_a = webpackStats.warnings) === null || _a === void 0 ? void 0 : _a.push({\n                    message\n                  });\n                  break;\n\n                case bundle_calculator_1.ThresholdSeverity.Error:\n                  (_b = webpackStats.errors) === null || _b === void 0 ? void 0 : _b.push({\n                    message\n                  });\n                  break;\n\n                default:\n                  assertNever(severity);\n              }\n            }\n          }\n\n          const buildSuccess = success && !(0, stats_1.statsHasErrors)(webpackStats);\n\n          if (buildSuccess) {\n            // Copy assets\n            if (!options.watch && ((_c = options.assets) === null || _c === void 0 ? void 0 : _c.length)) {\n              spinner.start('Copying assets...');\n\n              try {\n                yield (0, copy_assets_1.copyAssets)((0, utils_1.normalizeAssetPatterns)(options.assets, context.workspaceRoot, projectRoot, projectSourceRoot), Array.from(outputPaths.values()), context.workspaceRoot);\n                spinner.succeed('Copying assets complete.');\n              } catch (err) {\n                spinner.fail(color_1.colors.redBright('Copying of assets failed.'));\n                (0, error_1.assertIsError)(err);\n                return {\n                  success: false,\n                  error: 'Unable to copy assets: ' + err.message\n                };\n              }\n            }\n\n            if (options.index) {\n              spinner.start('Generating index html...');\n              const entrypoints = (0, package_chunk_sort_1.generateEntryPoints)({\n                scripts: (_d = options.scripts) !== null && _d !== void 0 ? _d : [],\n                styles: (_e = options.styles) !== null && _e !== void 0 ? _e : []\n              });\n              const indexHtmlGenerator = new index_html_generator_1.IndexHtmlGenerator({\n                cache: cacheOptions,\n                indexPath: path.join(context.workspaceRoot, (0, webpack_browser_config_1.getIndexInputFile)(options.index)),\n                entrypoints,\n                deployUrl: options.deployUrl,\n                sri: options.subresourceIntegrity,\n                optimization: normalizedOptimization,\n                crossOrigin: options.crossOrigin,\n                postTransform: transforms.indexHtml\n              });\n              let hasErrors = false;\n\n              for (const [locale, outputPath] of outputPaths.entries()) {\n                try {\n                  const {\n                    content,\n                    warnings,\n                    errors\n                  } = yield indexHtmlGenerator.process({\n                    baseHref: (_f = getLocaleBaseHref(i18n, locale)) !== null && _f !== void 0 ? _f : options.baseHref,\n                    // i18nLocale is used when Ivy is disabled\n                    lang: locale || undefined,\n                    outputPath,\n                    files: mapEmittedFilesToFileInfo(emittedFiles)\n                  });\n\n                  if (warnings.length || errors.length) {\n                    spinner.stop();\n                    warnings.forEach(m => context.logger.warn(m));\n                    errors.forEach(m => {\n                      context.logger.error(m);\n                      hasErrors = true;\n                    });\n                    spinner.start();\n                  }\n\n                  const indexOutput = path.join(outputPath, (0, webpack_browser_config_1.getIndexOutputFile)(options.index));\n                  yield fs.promises.mkdir(path.dirname(indexOutput), {\n                    recursive: true\n                  });\n                  yield fs.promises.writeFile(indexOutput, content);\n                } catch (error) {\n                  spinner.fail('Index html generation failed.');\n                  return {\n                    success: false,\n                    error: mapErrorToMessage(error)\n                  };\n                }\n              }\n\n              if (hasErrors) {\n                spinner.fail('Index html generation failed.');\n                return {\n                  success: false\n                };\n              } else {\n                spinner.succeed('Index html generation complete.');\n              }\n            }\n\n            if (options.serviceWorker) {\n              spinner.start('Generating service worker...');\n\n              for (const [locale, outputPath] of outputPaths.entries()) {\n                try {\n                  yield (0, service_worker_1.augmentAppWithServiceWorker)(projectRoot, context.workspaceRoot, outputPath, (_h = (_g = getLocaleBaseHref(i18n, locale)) !== null && _g !== void 0 ? _g : options.baseHref) !== null && _h !== void 0 ? _h : '/', options.ngswConfigPath);\n                } catch (error) {\n                  spinner.fail('Service worker generation failed.');\n                  return {\n                    success: false,\n                    error: mapErrorToMessage(error)\n                  };\n                }\n              }\n\n              spinner.succeed('Service worker generation complete.');\n            }\n          }\n\n          (0, stats_1.webpackStatsLogger)(context.logger, webpackStats, config, budgetFailures);\n          return {\n            success: buildSuccess\n          };\n        }\n      });\n\n      return function (_x5) {\n        return _ref2.apply(this, arguments);\n      };\n    }()), (0, operators_1.map)(event => ({ ...event,\n      baseOutputPath,\n      outputPath: baseOutputPath,\n      outputPaths: outputPaths && Array.from(outputPaths.values()) || [baseOutputPath],\n      outputs: outputPaths && [...outputPaths.entries()].map(([locale, path]) => {\n        var _a;\n\n        return {\n          locale,\n          path,\n          baseHref: (_a = getLocaleBaseHref(i18n, locale)) !== null && _a !== void 0 ? _a : options.baseHref\n        };\n      }) || {\n        path: baseOutputPath,\n        baseHref: options.baseHref\n      }\n    })));\n  }));\n\n  function getLocaleBaseHref(i18n, locale) {\n    var _a, _b;\n\n    if (i18n.locales[locale] && ((_a = i18n.locales[locale]) === null || _a === void 0 ? void 0 : _a.baseHref) !== '') {\n      return (0, utils_1.urlJoin)(options.baseHref || '', (_b = i18n.locales[locale].baseHref) !== null && _b !== void 0 ? _b : `/${locale}/`);\n    }\n\n    return undefined;\n  }\n}\n\nexports.buildWebpackBrowser = buildWebpackBrowser;\n\nfunction mapErrorToMessage(error) {\n  if (error instanceof Error) {\n    return error.message;\n  }\n\n  if (typeof error === 'string') {\n    return error;\n  }\n\n  return undefined;\n}\n\nfunction assertNever(input) {\n  throw new Error(`Unexpected call to assertNever() with input: ${JSON.stringify(input, null\n  /* replacer */\n  , 4\n  /* tabSize */\n  )}`);\n}\n\nfunction mapEmittedFilesToFileInfo(files = []) {\n  const filteredFiles = [];\n\n  for (const {\n    file,\n    name,\n    extension,\n    initial\n  } of files) {\n    if (name && initial) {\n      filteredFiles.push({\n        file,\n        extension,\n        name\n      });\n    }\n  }\n\n  return filteredFiles;\n}\n\nfunction checkInternetExplorerSupport(projectRoot, logger) {\n  const supportedBrowsers = (0, supported_browsers_1.getSupportedBrowsers)(projectRoot);\n\n  if (supportedBrowsers.some(b => b === 'ie 9' || b === 'ie 10' || b === 'ie 11')) {\n    logger.warn(`Warning: Support was requested for Internet Explorer in the project's browserslist configuration. ` + 'Internet Explorer is no longer officially supported.' + '\\nFor more information, see https://angular.io/guide/browser-support');\n  }\n}\n\nexports.default = (0, architect_1.createBuilder)(buildWebpackBrowser);","map":{"version":3,"names":["__createBinding","Object","create","o","m","k","k2","undefined","desc","getOwnPropertyDescriptor","__esModule","writable","configurable","enumerable","get","defineProperty","__setModuleDefault","v","value","__importStar","mod","result","prototype","hasOwnProperty","call","exports","buildWebpackBrowser","BUILD_TIMEOUT","architect_1","require","build_webpack_1","fs","path","rxjs_1","operators_1","typescript_1","utils_1","bundle_calculator_1","color_1","copy_assets_1","error_1","i18n_inlining_1","index_html_generator_1","normalize_cache_1","output_paths_1","package_chunk_sort_1","purge_cache_1","service_worker_1","spinner_1","supported_browsers_1","version_1","webpack_browser_config_1","configs_1","async_chunks_1","helpers_1","stats_1","initialize","options","context","webpackConfigurationTransform","_a","_b","originalOutputPath","outputPath","adjustedOptions","watch","assets","config","projectRoot","projectSourceRoot","i18n","target","generateI18nBrowserWebpackConfigFromContext","wco","getCommonConfig","getStylesConfig","getAnalyticsConfig","length","normalizeAssetPatterns","workspaceRoot","forEach","output","startsWith","Error","transformedConfig","deleteOutputPath","deleteOutputDir","transforms","projectName","project","baseOutputPath","resolve","outputPaths","assertCompatibleAngularVersion","from","getProjectMetadata","pipe","switchMap","projectMetadata","purgeStaleBuildCache","initialization","webpackConfiguration","checkInternetExplorerSupport","logger","indexInputFile","join","getIndexInputFile","index","plugins","push","apply","compiler","hooks","thisCompilation","tap","compilation","fileDependencies","add","cacheOptions","normalizeCacheOptions","normalizedOptimization","normalizeOptimization","optimization","runWebpack","webpackFactory","logging","stats","verbose","info","toString","concatMap","buildEvent","_c","_d","_e","_f","_g","_h","spinner","Spinner","enabled","progress","success","emittedFiles","webpackOutputPath","webpackRawStats","webpackStats","extraEntryPoints","normalizeExtraEntryPoints","styles","scripts","chunks","markAsyncChunksNonInitial","statsHasWarnings","warn","statsWarningsToString","colors","statsHasErrors","error","statsErrorsToString","ensureOutputPaths","scriptsEntryPointName","map","x","bundleName","shouldInline","i18nInlineEmittedFiles","Array","values","ScriptTarget","ES5","i18nMissingTranslation","budgets","budgetFailures","checkBudgets","severity","message","ThresholdSeverity","Warning","warnings","errors","assertNever","buildSuccess","start","copyAssets","succeed","err","fail","redBright","assertIsError","entrypoints","generateEntryPoints","indexHtmlGenerator","IndexHtmlGenerator","cache","indexPath","deployUrl","sri","subresourceIntegrity","crossOrigin","postTransform","indexHtml","hasErrors","locale","entries","content","process","baseHref","getLocaleBaseHref","lang","files","mapEmittedFilesToFileInfo","stop","indexOutput","getIndexOutputFile","promises","mkdir","dirname","recursive","writeFile","mapErrorToMessage","serviceWorker","augmentAppWithServiceWorker","ngswConfigPath","webpackStatsLogger","event","outputs","locales","urlJoin","input","JSON","stringify","filteredFiles","file","name","extension","initial","supportedBrowsers","getSupportedBrowsers","some","b","default","createBuilder"],"sources":["/Users/deliabarbuta/Documents/An4Sem1/PAW/Proiect/proiect-paw-tadam/Frontend_OceanCross/node_modules/@angular-devkit/build-angular/src/builders/browser/index.js"],"sourcesContent":["\"use strict\";\n/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.buildWebpackBrowser = exports.BUILD_TIMEOUT = void 0;\nconst architect_1 = require(\"@angular-devkit/architect\");\nconst build_webpack_1 = require(\"@angular-devkit/build-webpack\");\nconst fs = __importStar(require(\"fs\"));\nconst path = __importStar(require(\"path\"));\nconst rxjs_1 = require(\"rxjs\");\nconst operators_1 = require(\"rxjs/operators\");\nconst typescript_1 = require(\"typescript\");\nconst utils_1 = require(\"../../utils\");\nconst bundle_calculator_1 = require(\"../../utils/bundle-calculator\");\nconst color_1 = require(\"../../utils/color\");\nconst copy_assets_1 = require(\"../../utils/copy-assets\");\nconst error_1 = require(\"../../utils/error\");\nconst i18n_inlining_1 = require(\"../../utils/i18n-inlining\");\nconst index_html_generator_1 = require(\"../../utils/index-file/index-html-generator\");\nconst normalize_cache_1 = require(\"../../utils/normalize-cache\");\nconst output_paths_1 = require(\"../../utils/output-paths\");\nconst package_chunk_sort_1 = require(\"../../utils/package-chunk-sort\");\nconst purge_cache_1 = require(\"../../utils/purge-cache\");\nconst service_worker_1 = require(\"../../utils/service-worker\");\nconst spinner_1 = require(\"../../utils/spinner\");\nconst supported_browsers_1 = require(\"../../utils/supported-browsers\");\nconst version_1 = require(\"../../utils/version\");\nconst webpack_browser_config_1 = require(\"../../utils/webpack-browser-config\");\nconst configs_1 = require(\"../../webpack/configs\");\nconst async_chunks_1 = require(\"../../webpack/utils/async-chunks\");\nconst helpers_1 = require(\"../../webpack/utils/helpers\");\nconst stats_1 = require(\"../../webpack/utils/stats\");\n/**\n * Maximum time in milliseconds for single build/rebuild\n * This accounts for CI variability.\n */\nexports.BUILD_TIMEOUT = 30000;\nasync function initialize(options, context, webpackConfigurationTransform) {\n    var _a, _b;\n    const originalOutputPath = options.outputPath;\n    // Assets are processed directly by the builder except when watching\n    const adjustedOptions = options.watch ? options : { ...options, assets: [] };\n    const { config, projectRoot, projectSourceRoot, i18n, target } = await (0, webpack_browser_config_1.generateI18nBrowserWebpackConfigFromContext)(adjustedOptions, context, (wco) => [\n        (0, configs_1.getCommonConfig)(wco),\n        (0, configs_1.getStylesConfig)(wco),\n        (0, configs_1.getAnalyticsConfig)(wco, context),\n    ]);\n    // Validate asset option values if processed directly\n    if (((_a = options.assets) === null || _a === void 0 ? void 0 : _a.length) && !((_b = adjustedOptions.assets) === null || _b === void 0 ? void 0 : _b.length)) {\n        (0, utils_1.normalizeAssetPatterns)(options.assets, context.workspaceRoot, projectRoot, projectSourceRoot).forEach(({ output }) => {\n            if (output.startsWith('..')) {\n                throw new Error('An asset cannot be written to a location outside of the output path.');\n            }\n        });\n    }\n    let transformedConfig;\n    if (webpackConfigurationTransform) {\n        transformedConfig = await webpackConfigurationTransform(config);\n    }\n    if (options.deleteOutputPath) {\n        (0, utils_1.deleteOutputDir)(context.workspaceRoot, originalOutputPath);\n    }\n    return { config: transformedConfig || config, projectRoot, projectSourceRoot, i18n, target };\n}\n/**\n * @experimental Direct usage of this function is considered experimental.\n */\n// eslint-disable-next-line max-lines-per-function\nfunction buildWebpackBrowser(options, context, transforms = {}) {\n    var _a;\n    const projectName = (_a = context.target) === null || _a === void 0 ? void 0 : _a.project;\n    if (!projectName) {\n        throw new Error('The builder requires a target.');\n    }\n    const baseOutputPath = path.resolve(context.workspaceRoot, options.outputPath);\n    let outputPaths;\n    // Check Angular version.\n    (0, version_1.assertCompatibleAngularVersion)(context.workspaceRoot);\n    return (0, rxjs_1.from)(context.getProjectMetadata(projectName)).pipe((0, operators_1.switchMap)(async (projectMetadata) => {\n        var _a;\n        var _b;\n        // Purge old build disk cache.\n        await (0, purge_cache_1.purgeStaleBuildCache)(context);\n        // Initialize builder\n        const initialization = await initialize(options, context, transforms.webpackConfiguration);\n        // Check and warn about IE browser support\n        checkInternetExplorerSupport(initialization.projectRoot, context.logger);\n        // Add index file to watched files.\n        if (options.watch) {\n            const indexInputFile = path.join(context.workspaceRoot, (0, webpack_browser_config_1.getIndexInputFile)(options.index));\n            (_a = (_b = initialization.config).plugins) !== null && _a !== void 0 ? _a : (_b.plugins = []);\n            initialization.config.plugins.push({\n                apply: (compiler) => {\n                    compiler.hooks.thisCompilation.tap('build-angular', (compilation) => {\n                        compilation.fileDependencies.add(indexInputFile);\n                    });\n                },\n            });\n        }\n        return {\n            ...initialization,\n            cacheOptions: (0, normalize_cache_1.normalizeCacheOptions)(projectMetadata, context.workspaceRoot),\n        };\n    }), (0, operators_1.switchMap)(\n    // eslint-disable-next-line max-lines-per-function\n    ({ config, projectRoot, projectSourceRoot, i18n, target, cacheOptions }) => {\n        const normalizedOptimization = (0, utils_1.normalizeOptimization)(options.optimization);\n        return (0, build_webpack_1.runWebpack)(config, context, {\n            webpackFactory: require('webpack'),\n            logging: transforms.logging ||\n                ((stats, config) => {\n                    if (options.verbose) {\n                        context.logger.info(stats.toString(config.stats));\n                    }\n                }),\n        }).pipe((0, operators_1.concatMap)(async (buildEvent) => {\n            var _a, _b, _c, _d, _e, _f, _g, _h;\n            const spinner = new spinner_1.Spinner();\n            spinner.enabled = options.progress !== false;\n            const { success, emittedFiles = [], outputPath: webpackOutputPath } = buildEvent;\n            const webpackRawStats = buildEvent.webpackStats;\n            if (!webpackRawStats) {\n                throw new Error('Webpack stats build result is required.');\n            }\n            // Fix incorrectly set `initial` value on chunks.\n            const extraEntryPoints = [\n                ...(0, helpers_1.normalizeExtraEntryPoints)(options.styles || [], 'styles'),\n                ...(0, helpers_1.normalizeExtraEntryPoints)(options.scripts || [], 'scripts'),\n            ];\n            const webpackStats = {\n                ...webpackRawStats,\n                chunks: (0, async_chunks_1.markAsyncChunksNonInitial)(webpackRawStats, extraEntryPoints),\n            };\n            if (!success) {\n                // If using bundle downleveling then there is only one build\n                // If it fails show any diagnostic messages and bail\n                if ((0, stats_1.statsHasWarnings)(webpackStats)) {\n                    context.logger.warn((0, stats_1.statsWarningsToString)(webpackStats, { colors: true }));\n                }\n                if ((0, stats_1.statsHasErrors)(webpackStats)) {\n                    context.logger.error((0, stats_1.statsErrorsToString)(webpackStats, { colors: true }));\n                }\n                return { success };\n            }\n            else {\n                outputPaths = (0, output_paths_1.ensureOutputPaths)(baseOutputPath, i18n);\n                const scriptsEntryPointName = (0, helpers_1.normalizeExtraEntryPoints)(options.scripts || [], 'scripts').map((x) => x.bundleName);\n                if (i18n.shouldInline) {\n                    const success = await (0, i18n_inlining_1.i18nInlineEmittedFiles)(context, emittedFiles, i18n, baseOutputPath, Array.from(outputPaths.values()), scriptsEntryPointName, webpackOutputPath, target <= typescript_1.ScriptTarget.ES5, options.i18nMissingTranslation);\n                    if (!success) {\n                        return { success: false };\n                    }\n                }\n                // Check for budget errors and display them to the user.\n                const budgets = options.budgets;\n                let budgetFailures;\n                if (budgets === null || budgets === void 0 ? void 0 : budgets.length) {\n                    budgetFailures = [...(0, bundle_calculator_1.checkBudgets)(budgets, webpackStats)];\n                    for (const { severity, message } of budgetFailures) {\n                        switch (severity) {\n                            case bundle_calculator_1.ThresholdSeverity.Warning:\n                                (_a = webpackStats.warnings) === null || _a === void 0 ? void 0 : _a.push({ message });\n                                break;\n                            case bundle_calculator_1.ThresholdSeverity.Error:\n                                (_b = webpackStats.errors) === null || _b === void 0 ? void 0 : _b.push({ message });\n                                break;\n                            default:\n                                assertNever(severity);\n                        }\n                    }\n                }\n                const buildSuccess = success && !(0, stats_1.statsHasErrors)(webpackStats);\n                if (buildSuccess) {\n                    // Copy assets\n                    if (!options.watch && ((_c = options.assets) === null || _c === void 0 ? void 0 : _c.length)) {\n                        spinner.start('Copying assets...');\n                        try {\n                            await (0, copy_assets_1.copyAssets)((0, utils_1.normalizeAssetPatterns)(options.assets, context.workspaceRoot, projectRoot, projectSourceRoot), Array.from(outputPaths.values()), context.workspaceRoot);\n                            spinner.succeed('Copying assets complete.');\n                        }\n                        catch (err) {\n                            spinner.fail(color_1.colors.redBright('Copying of assets failed.'));\n                            (0, error_1.assertIsError)(err);\n                            return { success: false, error: 'Unable to copy assets: ' + err.message };\n                        }\n                    }\n                    if (options.index) {\n                        spinner.start('Generating index html...');\n                        const entrypoints = (0, package_chunk_sort_1.generateEntryPoints)({\n                            scripts: (_d = options.scripts) !== null && _d !== void 0 ? _d : [],\n                            styles: (_e = options.styles) !== null && _e !== void 0 ? _e : [],\n                        });\n                        const indexHtmlGenerator = new index_html_generator_1.IndexHtmlGenerator({\n                            cache: cacheOptions,\n                            indexPath: path.join(context.workspaceRoot, (0, webpack_browser_config_1.getIndexInputFile)(options.index)),\n                            entrypoints,\n                            deployUrl: options.deployUrl,\n                            sri: options.subresourceIntegrity,\n                            optimization: normalizedOptimization,\n                            crossOrigin: options.crossOrigin,\n                            postTransform: transforms.indexHtml,\n                        });\n                        let hasErrors = false;\n                        for (const [locale, outputPath] of outputPaths.entries()) {\n                            try {\n                                const { content, warnings, errors } = await indexHtmlGenerator.process({\n                                    baseHref: (_f = getLocaleBaseHref(i18n, locale)) !== null && _f !== void 0 ? _f : options.baseHref,\n                                    // i18nLocale is used when Ivy is disabled\n                                    lang: locale || undefined,\n                                    outputPath,\n                                    files: mapEmittedFilesToFileInfo(emittedFiles),\n                                });\n                                if (warnings.length || errors.length) {\n                                    spinner.stop();\n                                    warnings.forEach((m) => context.logger.warn(m));\n                                    errors.forEach((m) => {\n                                        context.logger.error(m);\n                                        hasErrors = true;\n                                    });\n                                    spinner.start();\n                                }\n                                const indexOutput = path.join(outputPath, (0, webpack_browser_config_1.getIndexOutputFile)(options.index));\n                                await fs.promises.mkdir(path.dirname(indexOutput), { recursive: true });\n                                await fs.promises.writeFile(indexOutput, content);\n                            }\n                            catch (error) {\n                                spinner.fail('Index html generation failed.');\n                                return { success: false, error: mapErrorToMessage(error) };\n                            }\n                        }\n                        if (hasErrors) {\n                            spinner.fail('Index html generation failed.');\n                            return { success: false };\n                        }\n                        else {\n                            spinner.succeed('Index html generation complete.');\n                        }\n                    }\n                    if (options.serviceWorker) {\n                        spinner.start('Generating service worker...');\n                        for (const [locale, outputPath] of outputPaths.entries()) {\n                            try {\n                                await (0, service_worker_1.augmentAppWithServiceWorker)(projectRoot, context.workspaceRoot, outputPath, (_h = (_g = getLocaleBaseHref(i18n, locale)) !== null && _g !== void 0 ? _g : options.baseHref) !== null && _h !== void 0 ? _h : '/', options.ngswConfigPath);\n                            }\n                            catch (error) {\n                                spinner.fail('Service worker generation failed.');\n                                return { success: false, error: mapErrorToMessage(error) };\n                            }\n                        }\n                        spinner.succeed('Service worker generation complete.');\n                    }\n                }\n                (0, stats_1.webpackStatsLogger)(context.logger, webpackStats, config, budgetFailures);\n                return { success: buildSuccess };\n            }\n        }), (0, operators_1.map)((event) => ({\n            ...event,\n            baseOutputPath,\n            outputPath: baseOutputPath,\n            outputPaths: (outputPaths && Array.from(outputPaths.values())) || [baseOutputPath],\n            outputs: (outputPaths &&\n                [...outputPaths.entries()].map(([locale, path]) => {\n                    var _a;\n                    return ({\n                        locale,\n                        path,\n                        baseHref: (_a = getLocaleBaseHref(i18n, locale)) !== null && _a !== void 0 ? _a : options.baseHref,\n                    });\n                })) || {\n                path: baseOutputPath,\n                baseHref: options.baseHref,\n            },\n        })));\n    }));\n    function getLocaleBaseHref(i18n, locale) {\n        var _a, _b;\n        if (i18n.locales[locale] && ((_a = i18n.locales[locale]) === null || _a === void 0 ? void 0 : _a.baseHref) !== '') {\n            return (0, utils_1.urlJoin)(options.baseHref || '', (_b = i18n.locales[locale].baseHref) !== null && _b !== void 0 ? _b : `/${locale}/`);\n        }\n        return undefined;\n    }\n}\nexports.buildWebpackBrowser = buildWebpackBrowser;\nfunction mapErrorToMessage(error) {\n    if (error instanceof Error) {\n        return error.message;\n    }\n    if (typeof error === 'string') {\n        return error;\n    }\n    return undefined;\n}\nfunction assertNever(input) {\n    throw new Error(`Unexpected call to assertNever() with input: ${JSON.stringify(input, null /* replacer */, 4 /* tabSize */)}`);\n}\nfunction mapEmittedFilesToFileInfo(files = []) {\n    const filteredFiles = [];\n    for (const { file, name, extension, initial } of files) {\n        if (name && initial) {\n            filteredFiles.push({ file, extension, name });\n        }\n    }\n    return filteredFiles;\n}\nfunction checkInternetExplorerSupport(projectRoot, logger) {\n    const supportedBrowsers = (0, supported_browsers_1.getSupportedBrowsers)(projectRoot);\n    if (supportedBrowsers.some((b) => b === 'ie 9' || b === 'ie 10' || b === 'ie 11')) {\n        logger.warn(`Warning: Support was requested for Internet Explorer in the project's browserslist configuration. ` +\n            'Internet Explorer is no longer officially supported.' +\n            '\\nFor more information, see https://angular.io/guide/browser-support');\n    }\n}\nexports.default = (0, architect_1.createBuilder)(buildWebpackBrowser);\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}